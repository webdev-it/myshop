<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ö–∞—Ç–∞–ª–æ–≥ ‚Äî –û–¥–µ–∂–¥–∞</title>
  <link rel="stylesheet" href="styles/style.css" />
</head>
<body>
  <header>
    <a href="index.html" class="back">‚Üê –ù–∞–∑–∞–¥</a>
    <h1>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –û–¥–µ–∂–¥–∞</h1>
  </header>

  <main>
    <div class="products" id="product-list"></div>
  </main>

  <script>
    // üö® –£–∫–∞–∑–∞–Ω –ø–æ–ª–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ ngrok
    const API_URL = 'https://brief-sculpin-willing.ngrok-free.app/products';

    const categoryId = '1'; // –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞

    async function fetchProducts() {
      const res = await fetch(API_URL);
      if (!res.ok) throw new Error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–æ–≤–∞—Ä–æ–≤');
      return await res.json();
    }

    function createProductCard(product) {
      const div = document.createElement('div');
      div.className = 'product';
      div.innerHTML = `
        <img src="${product.image}" alt="${product.name}" />
        <h2>${product.name}</h2>
        <p class="price">${product.price.toLocaleString()} ‚ÇΩ</p>
        <button class="buy-btn">–ö—É–ø–∏—Ç—å</button>
      `;

      div.querySelector('.buy-btn').addEventListener('click', () => {
        alert(`–í—ã –≤—ã–±—Ä–∞–ª–∏ —Ç–æ–≤–∞—Ä: ${product.name} –∑–∞ ${product.price} ‚ÇΩ`);
      });

      return div;
    }

    async function renderProducts() {
      try {
        const products = await fetchProducts();
        const filtered = products.filter(p => p.category === categoryId);

        const container = document.getElementById('product-list');
        container.innerHTML = '';

        if (filtered.length === 0) {
          container.textContent = '–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.';
          return;
        }

        filtered.forEach(product => {
          const card = createProductCard(product);
          container.appendChild(card);
        });
      } catch (err) {
        alert(err.message);
      }
    }

    renderProducts();
  </script>
</body>
</html>
